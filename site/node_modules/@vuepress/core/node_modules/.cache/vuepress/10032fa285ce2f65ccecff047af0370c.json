{"remainingRequest":"/home/geof/projects/refonte-schema/schema.data.gouv.fr/site/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/geof/projects/refonte-schema/schema.data.gouv.fr/site/site/.vuepress/theme/global-components/InventoryDataProxy.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/geof/projects/refonte-schema/schema.data.gouv.fr/site/site/.vuepress/theme/global-components/InventoryDataProxy.vue","mtime":1628086293279},{"path":"/home/geof/projects/refonte-schema/schema.data.gouv.fr/site/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/geof/projects/refonte-schema/schema.data.gouv.fr/site/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/geof/projects/refonte-schema/schema.data.gouv.fr/site/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/geof/projects/refonte-schema/schema.data.gouv.fr/site/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KCmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkludmVudG9yeURhdGFQcm94eSIsCiAgcHJvcHM6IFsibWFwcGluZyIsICJzdGF0dXNlcyJdLAogIG1vdW50ZWQoKSB7CiAgICBheGlvcy5nZXQoYCR7dGhpcy4kdGhlbWVDb25maWcuYXBpVXJsfS9pbnZlbnRhaXJlYCkudGhlbigocmVzKSA9PiB7CiAgICAgIGNvbnN0IGRhdGFzZXRzID0gdGhpcy50cmFuZm9ybVJlY29yZHMocmVzLmRhdGEucmVjb3Jkcyk7CgogICAgICBjb25zdCBsYXN0TW9kaWZpZWQgPSByZXMuZGF0YS5yZWNvcmRzCiAgICAgICAgLm1hcCgocikgPT4gci5maWVsZHNbIkxhc3QgTW9kaWZpZWQiXSkKICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5sb2NhbGVDb21wYXJlKGEpKVswXTsgLy8gVW4gcGV1IHNhbGUgbWFpcyDDqXZpdGUgZCdlbWJhcnF1ZXIgbG9kYXNoIG91IGF1dHJlCiAgICAgIHRoaXMuJGVtaXQoImlucHV0IiwgeyBkYXRhc2V0cywgbGFzdE1vZGlmaWVkIH0pOwogICAgfSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICB0cmFuZm9ybVJlY29yZHMocmVjb3JkcykgewogICAgICByZXR1cm4gcmVjb3Jkcy5tYXAoKHJlY29yZCkgPT4gewogICAgICAgIGNvbnN0IHJvdyA9IHt9OwoKICAgICAgICBPYmplY3QuZW50cmllcyh0aGlzLm1hcHBpbmcpLmZvckVhY2goKFtrZXksIGluZm9dKSA9PiB7CiAgICAgICAgICByb3dba2V5XSA9IHJlY29yZC5maWVsZHNbaW5mby5zb3VyY2VdOwogICAgICAgIH0pOwoKICAgICAgICByb3cucmF3ID0gcmVjb3JkLmZpZWxkczsKICAgICAgICByb3cuc3RhdHVzID0gdGhpcy5zdGF0dXNlcy5maW5kKChzKSA9PiBzLmxhYmVsID09IHJvdy5zdGF0dXMpOwogICAgICAgIHJvdy52aXNpYmxlID0gdHJ1ZTsKCiAgICAgICAgcmV0dXJuIHJvdzsKICAgICAgfSk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["InventoryDataProxy.vue"],"names":[],"mappings":";;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"InventoryDataProxy.vue","sourceRoot":"site/.vuepress/theme/global-components","sourcesContent":["<template />\n\n<script>\nimport axios from \"axios\";\n\nexport default {\n  name: \"InventoryDataProxy\",\n  props: [\"mapping\", \"statuses\"],\n  mounted() {\n    axios.get(`${this.$themeConfig.apiUrl}/inventaire`).then((res) => {\n      const datasets = this.tranformRecords(res.data.records);\n\n      const lastModified = res.data.records\n        .map((r) => r.fields[\"Last Modified\"])\n        .sort((a, b) => b.localeCompare(a))[0]; // Un peu sale mais Ã©vite d'embarquer lodash ou autre\n      this.$emit(\"input\", { datasets, lastModified });\n    });\n  },\n  methods: {\n    tranformRecords(records) {\n      return records.map((record) => {\n        const row = {};\n\n        Object.entries(this.mapping).forEach(([key, info]) => {\n          row[key] = record.fields[info.source];\n        });\n\n        row.raw = record.fields;\n        row.status = this.statuses.find((s) => s.label == row.status);\n        row.visible = true;\n\n        return row;\n      });\n    },\n  },\n};\n</script>\n"]}]}